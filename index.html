<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Drag Race Season Simulator</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="app">
    <h1>Drag Race Season Simulator</h1>

    <section class="controls">
      <div class="control-row">
        <label>
          Mode:
          <select id="modeSelect">
            <option value="normal">Normal</option>
            <option value="chaos">Chaos</option>
          </select>
        </label>
      </div>

      <div class="control-row">
        <label>
          Queens JSON:
          <textarea id="queensInput" rows="10" spellcheck="false"></textarea>
        </label>
      </div>

      <div class="control-row">
        <button id="loadDefaultQueens">Load sample cast</button>
        <button id="simulateButton">Simulate Season</button>
      </div>
    </section>

    <section class="output">
      <h2>Season Output</h2>
      <pre id="outputLog"></pre>
    </section>
  </main>

  <!-- Load data files first -->
  <script src="challenges.js"></script>
  <script src="queens.js"></script>

  <!-- Simulator core -->
  <script src="sim.js"></script>

  <!-- UI glue -->
  <script>
    const queensInput = document.getElementById("queensInput");
    const modeSelect = document.getElementById("modeSelect");
    const loadDefaultBtn = document.getElementById("loadDefaultQueens");
    const simulateBtn = document.getElementById("simulateButton");
    const outputLog = document.getElementById("outputLog");

    loadDefaultBtn.addEventListener("click", () => {
      if (!window.QUEENS) {
        outputLog.textContent = "Error: queens.js not loaded or window.QUEENS is undefined.";
        return;
      }
      queensInput.value = JSON.stringify(window.QUEENS, null, 2);
    });

    simulateBtn.addEventListener("click", () => {
      let queens;
      try {
        queens = JSON.parse(queensInput.value);
      } catch (err) {
        outputLog.textContent = "Invalid Queens JSON:\n\n" + err;
        return;
      }

      const mode = modeSelect.value;
      const result = window.simulateSeason(queens, { mode });
      outputLog.textContent = result;
    });

    // Auto-load sample cast on page load
    window.addEventListener("DOMContentLoaded", () => {
      if (window.QUEENS) {
        queensInput.value = JSON.stringify(window.QUEENS, null, 2);
      }
    });
  </script>
</body>
</html>
